<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>–¢—Ä–µ–∫–µ—Ä —É—Å–ø–µ—Ö–æ–≤ üå±üå∏</title>
<link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><circle cx='50' cy='50' r='45' fill='%2396C93D'/><path d='M50 20 L50 80 M20 50 L80 50' stroke='white' stroke-width='10'/></svg>">
<style>
body { font-family:-apple-system,BlinkMacSystemFont,sans-serif; margin:0; padding:0; background:#f9f9f9; }
header { background:#96C93D; color:#fff; text-align:center; padding:20px; font-size:1.5em; }
.container { padding:20px; }
input, select, button { width:100%; padding:10px; margin:5px 0; border-radius:5px; border:1px solid #ccc; font-size:1em; }
button { background:#96C93D; color:#fff; border:none; cursor:pointer; transition:0.3s; }
button:hover { background:#82b636; }
.goal { background:#fff; padding:10px; margin:10px 0; border-radius:8px; box-shadow:0 2px 5px rgba(0,0,0,0.1); }
.progress { background:#eee; border-radius:5px; overflow:hidden; height:12px; margin-top:5px; }
.progress-bar { height:12px; background:#96C93D; width:0%; transition:0.5s; }
.motivation { margin:10px 0; font-weight:bold; color:#2e7d32; font-size:1em; text-align:center; }
#plant-container { text-align:center; margin:20px 0; height:200px; position:relative; }
.plant { display:inline-block; width:20px; background:#2e7d32; border-radius:10px 10px 0 0; transform-origin: bottom; transition:height 0.5s; }
.leaf { width:10px; height:5px; background:#4caf50; position:absolute; border-radius:50%; opacity:0; transition:opacity 0.5s, transform 0.5s; }
.flower { width:15px; height:15px; background:#ff4081; border-radius:50%; position:absolute; opacity:0; transition:opacity 0.5s; }
</style>
</head>
<body>

<header>üå± –¢—Ä–µ–∫–µ—Ä —É—Å–ø–µ—Ö–æ–≤</header>
<div class="container">
  <select id="period">
    <option value="day">–î–µ–Ω—å</option>
    <option value="week">–ù–µ–¥–µ–ª—è</option>
    <option value="month">–ú–µ—Å—è—Ü</option>
    <option value="year">–ì–æ–¥</option>
  </select>
  <input type="text" id="goalText" placeholder="–ù–æ–≤–∞—è —Ü–µ–ª—å">
  <button onclick="addGoal(event)">–î–æ–±–∞–≤–∏—Ç—å —Ü–µ–ª—å</button>
  <div class="motivation" id="motivation"></div>
  <div id="plant-container">
    <div class="plant" id="plant"></div>
    <div class="leaf" id="leaf1"></div>
    <div class="leaf" id="leaf2"></div>
    <div class="flower" id="flower"></div>
  </div>
  <div id="goalsContainer"></div>
</div>

<script>
const goalsKey = 'myGoals_v2';
const motivationTexts = [
  "–¢—ã —Å–ø–æ—Å–æ–±–µ–Ω –Ω–∞ –±–æ–ª—å—à–µ–µ! üí™",
  "–ö–∞–∂–¥—ã–π —à–∞–≥ –ø—Ä–∏–±–ª–∏–∂–∞–µ—Ç –∫ —Ü–µ–ª–∏! üåü",
  "–¢—ã —Ä–∞—Å—Ç–µ—à—å –∏ —Ä–∞–∑–≤–∏–≤–∞–µ—à—å—Å—è! üå±",
  "–°–æ—Å—Ä–µ–¥–æ—Ç–æ—á—å—Å—è –∏ –¥–µ–π—Å—Ç–≤—É–π! üî•",
  "–í–µ–ª–∏–∫–∏–µ –¥–µ–ª–∞ –Ω–∞—á–∏–Ω–∞—é—Ç—Å—è —Å –º–∞–ª–µ–Ω—å–∫–∏—Ö —à–∞–≥–æ–≤! üöÄ"
];

function getRandomMotivation() {
  return motivationTexts[Math.floor(Math.random()*motivationTexts.length)];
}

function loadGoals() {
  try {
    const data = localStorage.getItem(goalsKey);
    if (!data) return { day: [], week: [], month: [], year: [] };
    return JSON.parse(data);
  } catch (e) {
    console.error("–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:", e);
    return { day: [], week: [], month: [], year: [] };
  }
}

function saveGoals(goals) {
  try {
    localStorage.setItem(goalsKey, JSON.stringify(goals));
  } catch (e) {
    console.error("–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:", e);
    alert("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —Ü–µ–ª–∏. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –±—Ä–∞—É–∑–µ—Ä–∞.");
  }
}

function updatePlant() {
  const period = document.getElementById('period').value;
  const goals = loadGoals()[period] || [];
  const doneCount = goals.filter(g => g.done).length;
  const plant = document.getElementById('plant');
  
  plant.style.height = 50 + doneCount*15 + 'px';
  
  // –ê–Ω–∏–º–∞—Ü–∏—è –ª–∏—Å—Ç—å–µ–≤ –∏ —Ü–≤–µ—Ç–∫–∞
  document.getElementById('leaf1').style.opacity = doneCount >= 2 ? 1 : 0;
  document.getElementById('leaf2').style.opacity = doneCount >= 4 ? 1 : 0;
  document.getElementById('flower').style.opacity = doneCount >= 6 ? 1 : 0;
}

function renderGoals() {
  const container = document.getElementById('goalsContainer');
  if (!container) return;
  
  container.innerHTML = '';
  const period = document.getElementById('period').value;
  const goals = loadGoals()[period] || [];
  
  goals.forEach((goal, i) => {
    const div = document.createElement('div');
    div.className = 'goal';
    div.innerHTML = `
      <div>${goal.text}</div>
      <div class="progress">
        <div class="progress-bar" style="width:${goal.done ? 100 : 0}%"></div>
      </div>
      <button onclick="toggleDone(${i})">${goal.done ? '–°–±—Ä–æ—Å–∏—Ç—å' : '–í—ã–ø–æ–ª–Ω–µ–Ω–æ'}</button>
      <button onclick="deleteGoal(${i})" style="background:#e74c3c">–£–¥–∞–ª–∏—Ç—å</button>
    `;
    container.appendChild(div);
  });
  
  document.getElementById('motivation').textContent = getRandomMotivation();
  updatePlant();
}

function addGoal(e) {
  e.preventDefault();
  const text = document.getElementById('goalText').value.trim();
  if (!text) return;
  
  const period = document.getElementById('period').value;
  const goals = loadGoals();
  
  if (!goals[period]) goals[period] = [];
  goals[period].push({ text, done: false });
  
  saveGoals(goals);
  document.getElementById('goalText').value = '';
  renderGoals();
}

function toggleDone(index) {
  const period = document.getElementById('period').value;
  const goals = loadGoals();
  goals[period][index].done = !goals[period][index].done;
  saveGoals(goals);
  renderGoals();
}

function deleteGoal(index) {
  if (!confirm("–£–¥–∞–ª–∏—Ç—å —Ü–µ–ª—å?")) return;
  
  const period = document.getElementById('period').value;
  const goals = loadGoals();
  goals[period].splice(index, 1);
  saveGoals(goals);
  renderGoals();
}

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
document.addEventListener('DOMContentLoaded', () => {
  if (typeof localStorage === 'undefined') {
    alert("–û—à–∏–±–∫–∞: localStorage –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –±—Ä–∞—É–∑–µ—Ä.");
    return;
  }
  renderGoals();
  document.getElementById('period').addEventListener('change', renderGoals);
});
</script>
</body>
</html>
